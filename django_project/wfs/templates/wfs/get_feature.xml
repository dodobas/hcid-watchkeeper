<?xml version="1.0" encoding="UTF-8"?>
<wfs:FeatureCollection
    timeStamp="{{ timestamp }}"
    numberMatched="{{ data|length }}"
    numberReturned="{{ data|length }}"
    xmlns="http://www.someserver.example.com/myns"
    xmlns:wfs="http://www.opengis.net/wfs/2.0"
    xmlns:gml="http://www.opengis.net/gml/3.2"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.opengis.net/wfs/2.0
                       http://schemas.opengis.net/wfs/2.0/wfs.xsd
                       http://www.opengis.net/gml/3.2
                       http://schemas.opengis.net/gml/3.2.1/gml.xsd">
    <wfs:boundedBy>
        <gml:Envelope srsName="http://www.opengis.net/def/crs/epsg/0/4326">
            {% if bbox %}
                <gml:lowerCorner>{{ bbox.x_min }} {{ bbox.y_min }}</gml:lowerCorner>
                <gml:upperCorner>{{ bbox.x_max }} {{ bbox.y_max }}</gml:upperCorner>
            {% else %}
                <gml:lowerCorner>-180 -90</gml:lowerCorner>
                <gml:upperCorner>180 90</gml:upperCorner>
            {% endif %}
        </gml:Envelope>
    </wfs:boundedBy>
    <!-- https://stackoverflow.com/questions/13376576/how-can-i-use-a-variable-as-index-in-django-template -->
    {% for record in data %}
        <wfs:member>
            <Waterpoints>
                <location>
                    <gml:Point gml:id="{{ record.feature_uuid }}" srsName="http://www.opengis.net/def/crs/epsg/0/4326">
                        <gml:pos>{{ record.longitude }} {{ record.latitude }}</gml:pos>
                    </gml:Point>
                </location>
                {% for key, value in record.items %}
                    <{{ key }}>{{ value }}</{{ key }}>
                {% endfor %}
            </Waterpoints>
        </wfs:member>
    {% endfor %}
</wfs:FeatureCollection>
