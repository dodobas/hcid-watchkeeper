{% extends "dashboards/dashboard-base.html" %}
{% load pipeline %}

{% block content %}
<style>
.toolTip {
  position: absolute;
  display: none;
  min-width: 80px;
  height: auto;
  background: none repeat scroll 0 0 #ffffff;
  border: 1px solid #6F257F;
  padding: 14px;
  text-align: center;
}
</style>
    <div class="container-fluid">

    <div class="row">
        <div class="col-sm-1">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Groups</h3>
                </div>
                <div class="panel-body">
                    <div id="groupsCnt"></div>
               </div>
            </div>
        </div>

        <div class="col-sm-1">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Items</h3>
                </div>
                <div class="panel-body">
                    <div id="itemsCnt"></div>
               </div>
            </div>
        </div>

    </div>



    <div class="row">
        <div class="col-sm-6">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Groups</h3>
                </div>
                <div class="panel-body">
                    <div id="groupChartWrap"></div>
               </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Fencing</h3>
                </div>
                <div class="panel-body">
                    <div id="fencingChartWrap"></div>
               </div>
            </div>
        </div>

    </div>


          <div class="row">
        <div class="col-sm-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Fencing Bar</h3>
                </div>
                <div class="panel-body">
                    <div id="fencingBarChartWrap"></div>
               </div>
            </div>
        </div>

    </div>




          <div class="row">
        <div class="col-sm-6">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Functional</h3>
                </div>
                <div class="panel-body">
                    <div id="functioningChartWrap"></div>
               </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Scheme Type</h3>
                </div>
                <div class="panel-body">
                    <div id="schemetypeChartWrap"></div>
               </div>
            </div>
        </div>

    </div>
        {#        # groupChartWrap, fencingChartWrap, yieldChartWrap, functioningChartWrap, schemetypeChartWrap#}



    <div class="row">
{#    left side #}
    <div class="col-sm-6">
        <div class="row">
            <div class="col-sm-12">
                {# chart#}

                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Yield</h3>
                    </div>
                    <div class="panel-body">
                        <div id="yieldChartWrap" class='wb-pie-chart'></div>
                    </div>
                </div>

            </div>
        </div>


        <div class="row">
            <div class="col-sm-12">
                {#        chart#}


            </div>
        </div>
    </div>
{#  left side end#}
{#  right side#}
    <div class="col-sm-6">

        <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Map</h3>
                    </div>
                    <div class="panel-body">
                        <div id="featureMapWrap" class='wb-map-wrap'></div>
                    </div>
                </div>
    </div>
{#  right side end#}
</div>


    </div>




{% endblock %}

{% block extra_js %}
    <script>
        var data = JSON.parse("{{ group_cnt | escapejs }}");

        var fencing_cnt = JSON.parse("{{ fencing_cnt | escapejs }}");
        var schemetype_cnt = JSON.parse("{{ schemetype_cnt | escapejs }}");
        var functioning_cnt = JSON.parse("{{ functioning_cnt | escapejs }}");
        var yield_cnt = JSON.parse("{{ yield_cnt | escapejs }}");

        var itemsCnt = document.getElementById('itemsCnt');
        var groupsCnt = document.getElementById('groupsCnt');

        itemsCnt.innerHTML = 0;
        groupsCnt.innerHTML = 0;

        if ((data || []) && data.length > 0) {
            itemsCnt.innerHTML = _.sumBy(data, 'cnt');
            groupsCnt.innerHTML = data.length;

            var chart = donutChart({
                data: data,
                parentId: '#groupChartWrap',
                svgClass: 'pie'
            });
        }



        var fencing_groups = _.groupBy(fencing_cnt, 'group');
        var fencing_groups_sum = [];

        _.forEach(fencing_groups, (i, key) => {
           fencing_groups_sum[fencing_groups_sum.length] = {
               name: key,
               value: _.sumBy(i, 'cnt')
           };
        });
        //_.map(_.uniqBy(fencing_cnt, 'group'), (i) => i.group)
        var fencingChart = donutChart({
            data: fencing_cnt,
            parentId: '#fencingChartWrap',
            svgClass: 'pie'
        });

        var fencingBarChart = barChart({
            data: fencing_groups_sum,
            parentId: '#fencingBarChartWrap',
            svgClass: 'pie'
        });
// fencingBarChartWrap

        var schemetypeChart = donutChart({
            data: schemetype_cnt,
            parentId: '#schemetypeChartWrap',
            svgClass: 'pie'
        });

        var yieldChart = donutChart({
            data: yield_cnt,
            parentId: '#yieldChartWrap',
            svgClass: 'pie'
        });

        var functioningChart = donutChart({
            data: functioning_cnt,
            parentId: '#functioningChartWrap',
            svgClass: 'pie'
        });

    </script>
{% endblock %}
