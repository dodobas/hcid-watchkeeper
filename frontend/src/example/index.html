<!DOCTYPE html>
<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.10/lodash.js"></script>
    <!-- <script src="build/WBLib.min.js"></script> -->
    <script src="build/WBLib.min.js"></script>


    <style>
       div.example-block{
           display: flex;
           flex-direction: row;
           justify-content: space-around;
       }

        div.example-block > div{
            flex: 1;
       }
    </style>
</head>
<body>
<div id="form-nav" class="form-nav"></div>
<form id="example-form"></form>
<!--
<div class="example-block">
    <div id="example_1_text">
        <pre>
            <code>

            </code>
        </pre>
    </div>
    <div id="example_1_input">B</div>
    <div id="example_1_result">C</div>
</div>-->
<script>

  const formTabs = {};
  let activeTab = 'location_description';

    const {form} = WBLib;
    const {
        attribute_attributes,
        attribute_groups,
        feature_data
    } = form.sampleFormData;

    const sampleInputTextField = attribute_attributes.name;

    const templateString = form.formFields.textInputFieldTemplate(sampleInputTextField);

    console.log('templateString', templateString);

    let groupedFieldsByType =_.groupBy(attribute_attributes, 'attribute_group');

    console.log('groupedFieldsByType', groupedFieldsByType);

    let fieldObj, attrGroup;
    let formObj = document.getElementById('example-form');

    function createFormNavigation (fields) {

      // set nav
      let formNavParent = document.getElementById('form-nav');

      formNavParent.addEventListener('click', function (e) {
        let tabKey = e.target.name;
        if (tabKey && formTabs[`${tabKey}`]) {
          formTabs[`${activeTab}`].style.display = 'none';
          activeTab = tabKey;
          formTabs[`${activeTab}`].style.display = 'block';
        }

      });


      _.forEach(fields, (attrGroupFields, key) => {
            let name = _.get(attribute_groups, `${key}.label`, ' - ');
            formNavParent.innerHTML += `<button name="${key}">${name}</button>`;
      });
    }
    createFormNavigation(groupedFieldsByType);
  /*
    // set nav
    let formNavParent = document.getElementById('form-nav');

    formNavParent.addEventListener('click', function (e) {
      let tabKey = e.target.name;
      if (tabKey && formTabs[`${tabKey}`]) {
        formTabs[`${activeTab}`].style.display = 'none';
        activeTab = tabKey;
        formTabs[`${activeTab}`].style.display = 'block';
      }

    });


    _.forEach(groupedFieldsByType, (attrGroupFields, key) => {
          let name = _.get(attribute_groups, `${key}.label`, ' - ');
          formNavParent.innerHTML += `<button name="${key}">${name}</button>`;
    });
*/

    // FORM CONTENT

    _.forEach(groupedFieldsByType, (attrGroupFields, key) => {

        attrGroup = attribute_groups[`${key}`];
        let wrap = document.createElement('div');
        wrap.id = `${key}`;
        wrap.style.display = 'none';

        // formObj.innerHTML += `<h2>${attrGroup.label}</h2>`;
        wrap.innerHTML += `<h2>${attrGroup.label}</h2>`;


        _.forEach(attrGroupFields, (field) => {
            //let val = field.key;
            field.value = feature_data[`${field.key}`] || '';

            fieldObj = form.formFields.createDomObjectFromTemplate(
                form.formFields.textInputFieldTemplate(field)
            );
            wrap.appendChild(fieldObj);
        });
        formTabs[`${key}`] = wrap;

        formObj.appendChild(wrap);

    });

    formTabs[`${activeTab}`].style.display = 'block';
</script>
</body>
</html>
